---
title: رویداد ها
sidebar_position: 2
---

# رویداد ها

## delegate

### نکات مهم

- دلیگیت می تواند داخل یا خارج کلاس نوشته شود

- نوع تابع دلیگیت باید با نوع تابع های سابسکرایب کننده یکی باشد.
یعنی اگر دلیگیت void است همه ی سابسکرایب کننده ها هم باید void باشند.
اگر دلیگیت int است همه ی سابسکرایب کننده ها هم باید int باشند.

- به لحاظ تعداد و نوع پارامترها هم تابع های سابسکرایب کننده باید با دلیگیت یکسان باشند. یعنی اگر دلیگیت 2 پارامتر int دارد سابسکرایب کننده ها هم باید دو پارامتر int داشته باشند.
نکته ای که وجود دارد این است که مقادیری که به رویداد هنگام فرخوانی (اجرا) می دهیم به همه ی تابع های سابسکرایب کنند پاس داده می شود.

- فراخوانی رویداد به هر دو روش زیر درست است اما استفاده از invoke مدرن تر و ایمن تر است.
با ؟ چک می کنیم که سابسکرایب کننده ای وجود دارد یا نه و با invoke تابع را اجرا می کنیم.

```
    OnHealthChanged?.Invoke(current, max);
    یا 
    if(OnHealthChanged != null) {
        OnHealthChanged(current, max)
    }

```


- سابسکرایب در OnEnabled و آنسابسکرایب در OnDisabled انجام میشود و حتما باید برای جلوگیری از مموری لیکینگ انسابسکرایب انجام شود.

- می توان event را استاتیک تعریف کرد اما کار درستی نیست.

:::note
کلمه ی کلیدی استاتیک باعث می شود که یک نسخه ی عمومی و مشترک در برنامه ساخته شود که وابسته به کلاس است و نه شی.
به این معنی که برای دسترسی به آن نیازی به ساخت شی از کلاس نیست و مستقیما در دسترس است.
:::

```
// تعریف delegate دلخواه
public delegate void HealthChanged(int current, int max);

public class Player : MonoBehaviour
{
    // رویداد
    public event HealthChanged OnHealthChanged;

    int current = 100, max = 100;

    void TakeDamage(int dmg)
    {
        current = Mathf.Max(current - dmg, 0);
        // فراخوانی ایمن (۳ علامت سؤال = null-check)
        OnHealthChanged?.Invoke(current, max);
    }
}

```
