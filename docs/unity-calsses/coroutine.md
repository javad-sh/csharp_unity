---
title: Coroutine
sidebar_position: 8
---

# Coroutine

در یونیتی، Coroutine (کوروتین) یکی از ابزارهای مهم برای اجرای توابع به‌صورت غیرهم‌زمان (asynchronous) است، بدون اینکه بازی را متوقف کند. کوروتین‌ها برای اجرای کدهایی که نیاز به تأخیر، انتظار یا تقسیم پردازش در چند فریم دارند بسیار مفید هستند.

## تعریف Coroutine چیست؟

یک Coroutine تابعی است که می‌تواند در طول چندین فریم اجرا شود. برخلاف توابع عادی که به‌طور کامل در یک فریم اجرا می‌شوند، Coroutine با استفاده از yield می‌تواند موقتاً متوقف شود و در فریم‌های بعدی ادامه یابد.

## نحوه ی تعریف

برای تعریف کروتین یک تابع از نوع IEnumerator تعریف می کنیم.
سپس برای ایجاد تاخیر در اجرا از yield return استفاده می کنیم.

| دستور                                    | توضیح                                     |
| ---------------------------------------- | ----------------------------------------- |
| `yield return null;`                     | اجرا تا فریم بعدی متوقف می‌شود.           |
| `yield return new WaitForSeconds(t);`    | به مدت `t` ثانیه صبر می‌کند.              |
| `yield return new WaitForEndOfFrame();`  | تا پایان فریم فعلی صبر می‌کند.            |
| `yield return new WaitForFixedUpdate();` | تا اجرای بعدی `FixedUpdate()` صبر می‌کند. |
| `yield return StartCoroutine(...);`      | منتظر پایان یک Coroutine دیگر می‌ماند.    |
| `yield break;`                           | اجرای Coroutine را متوقف می‌کند.          |

## توابع مرتبط

| تابع                               | توضیح                                   |
| ---------------------------------- | --------------------------------------- |
| `StartCoroutine(IEnumerator)`      | شروع یک کوروتین                         |
| `StopCoroutine(IEnumerator)`       | توقف کوروتین خاص                        |
| `StopCoroutine(string methodName)` | توقف کوروتین با نام تابع                |
| `StopAllCoroutines()`              | توقف همه کوروتین‌های MonoBehaviour جاری |

## ویژگی‌های Coroutine

| ویژگی                            | توضیح                                                                               |
| -------------------------------- | ----------------------------------------------------------------------------------- |
| **غیرمسدودکننده (Non-blocking)** | بازی متوقف نمی‌شود؛ کوروتین‌ها به‌صورت موازی اجرا می‌شوند.                          |
| **مدیریت زمان**                  | بسیار مناسب برای زمان‌بندی، انیمیشن‌های تدریجی، دیالوگ‌ها، تاخیر‌ها و غیره.         |
| **قابل کنترل**                   | می‌توان کوروتین را متوقف (`StopCoroutine`) یا همه را پاک کرد (`StopAllCoroutines`). |
| **خوانا بودن کد**                | نسبت به استفاده از `Invoke` یا `Update` برای تأخیرها، کد مرتب‌تر و واضح‌تر می‌شود.  |

## مثال

```
IEnumerator Blink()
{
    while (true)
    {
        spriteRenderer.enabled = false;
        yield return new WaitForSeconds(0.5f);

        spriteRenderer.enabled = true;
        yield return new WaitForSeconds(0.5f);
    }
}

```
