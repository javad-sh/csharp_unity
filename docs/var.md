---
title: var در سی شارپ
sidebar_position: 20
---



### var در C# چیست؟

`var` یک *کلیدواژه* برای **تعریف متغیرهای محلی با نوع ضمنی** (Implicitly-typed local variables) است. وقتی کامپایلر مقدار اولیه را می‌بیند، می‌تواند نوع واقعی را استنباط کند و دقیقاً همان نوع را جایگزین `var` ‌کند؛ بنابراین کد همچنان **Strongly-typed** باقی می‌ماند و هیچ شباهتی به «جاوااسکریپت» یا «dynamic» ندارد.

---

## قوانین استفاده از `var`

| ✔️ مجاز است                                         | ❌ مجاز نیست                                             | توضیح کوتاه                                                                     |
| --------------------------------------------------- | ------------------------------------------------------- | ------------------------------------------------------------------------------- |
| تعریف متغیر *محلی* در متد / بلاک                    | تعریف فیلد کلاس، پارامتر متد، نوع بازگشتی               | `var` فقط در محدوده محلی کاربرد دارد                                            |
| حتماً باید **همان خط** مقداردهی شود                 | `var x;` (بدون مقدار اولیه)                             | چون کامپایلر بدون مقدار نمی‌تواند نوع را تشخیص دهد                              |
| مقدار اولیه نباید `null` خالی باشد                  | `var n = null;`                                         | با `null` نوع مشخص نمی‌شود؛ می‌توانید `string? n = null;` بنویسید               |
| نوع پس از کامپایل **ثابت** می‌شود و قابل تغییر نیست | `var x = 3; x = "text";`                                | بعد از استنباط به `int`، انتساب رشته خطا می‌دهد                                 |
| در دستورهای `foreach`, `using`, `for` مجاز است      | در عبارت‌های شرطی (`if(var x = ...)`) تا C# 8 مجاز نبود | در نسخه‌های جدید الگوهای `var` در pattern-matching اضافه شده است                |
| مناسب برای خروجی‌های پیچیده (LINQ, anonymous type)  | جایی که خوانایی را کاهش دهد                             | مایکروسافت توصیه می‌کند وقتی نوع کاملاً واضح است یا نام طولانی دارد استفاده شود |

---

## مثال‌های ساده و مهم

```csharp
using System;
using System.Collections.Generic;
using System.Linq;

class Demo
{
    static void Main()
    {
        // 1. مقداردهی عددی ساده
        var number = 42;        // ↔️ int

        // 2. نوع طولانی
        var dict = new Dictionary<string, List<int>>(); // ↔️ Dictionary<string,List<int>>

        // 3. حلقه foreach
        var names = new[] { "Ali", "Sara", "John" };
        foreach (var n in names)
            Console.WriteLine(n);   // n ↔️ string

        // 4. استفاده در دستور using
        using var file = System.IO.File.OpenRead("data.txt"); // ↔️ FileStream

        // 5. LINQ با نوع ناشناس
        var adults =
            from p in GetPeople()
            where p.Age >= 18
            select new { p.Name, p.Age }; // نوع ناشناس است و بدون var ممکن نیست

        // 6. بررسی نوع ثابت
        // number = "متن";   // ⛔ خطا؛ نوع number قبلاً int شده است
    }

    static IEnumerable<Person> GetPeople() => new[]
    {
        new Person { Name = "Ali",  Age = 20 },
        new Person { Name = "Mary", Age = 15 }
    };
}

record Person { public string Name { get; set; } = ""; public int Age { get; set; } }
```

---

## توصیه‌های سبک کدنویسی (Best Practices)

1. **خوانایی را قربانی نکنید**
   وقتی نوع سمت راست کاملاً آشکار است (`var age = 30;`) یا بسیار طولانی است، `var` مفید است؛ ولی برای عباراتی مثل `Customer c = new Customer();` اغلب خواناتر است نوع را بنویسید.

2. **سازگاری تیمی**
   از یک راهنمای مشترک (Style Guide) پیروی کنید تا کد تیم یکنواخت باشد—برای نمونه، راهنمای رسمی ‎.NET‌ (FxCop / Roslyn Analyzers) یا StyleCop.

3. **ابزار تحلیل ایستا**
   بیشتر IDEها (Visual Studio, Rider, VS Code) می‌توانند استفادهٔ مناسب / نامناسب `var` را هشدار دهند؛ تنظیم آن‌ها به بهبود کیفیت کد کمک می‌کند.

---

### جمع‌بندی

`var` نوشتار کد را کوتاه می‌کند بدون آنکه ایمنی نوع در C# از بین برود. کافی است آن را **فقط برای متغیرهای محلی همراه مقدار اولیه‌ای که نوع دقیقش واضح است** به کار ببرید و در موارد دیگر سراغ اعلان صریح نوع بروید تا کد قابل‌خواندن و خطاهای زمان کامپایل قابل‌اعتماد باقی بمانند.
